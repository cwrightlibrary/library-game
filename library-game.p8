pico-8 cartridge // http://www.pico-8.com
version 41
__lua__
--game loop
function _init()
 _palette()
 _world()
 _player()
end

function _draw()
 world:draw()
 player:draw()
end

function update60()

end
-->8
--test
function _palette()
 pal({[0]=0,1,128,141,4,5,6,7,14,9,143,134,132,13,140,15},1)
 if time()<=1 then
  poke(0x5f2e,1)
 end
end

function _world()
 world={sp=64,fdesk_f={sp=68,x=40,y=39,w=3,h=3},fdesk_r={sp=71,x=40,y=58,w=3,h=3}}
 world.draw=function()
  cls(world.bg1)
  for x=0,15 do
   for y=0,15 do
    if (x>5 and x<14) and y<4 then
     pal(13,3)
     spr(world.sp,x*8,y*8)
     _palette()
    else
     pal()
     spr(world.sp,x*8,y*8)
     _palette()
    end
   end
  end
  --front desk
  spr(world.fdesk_f.sp,world.fdesk_f.x,world.fdesk_f.y,world.fdesk_f.w,world.fdesk_f.h)
  spr(world.fdesk_f.sp,world.fdesk_f.x+24,world.fdesk_f.y,world.fdesk_f.w,world.fdesk_f.h,true)
  spr(world.fdesk_r.sp,world.fdesk_r.x,world.fdesk_r.y,world.fdesk_r.w,world.fdesk_r.h)
  spr(world.fdesk_r.sp,world.fdesk_r.x+24,world.fdesk_r.y,world.fdesk_r.w,world.fdesk_r.h,true)
  --shelves behind front desk
  for i=0,2 do
   --fiction
   spr(67,55+(i*18),-3,1,3)
   spr(67,55+(i*18),2,1,3)
   --movies
   spr(67,-20+(i*18),-3,1,3)
   spr(67,-20+(i*18),2,1,3)
   --audiobooks
   if i>0 then
    spr(65,-12+(i*12),19,2,3) --spr(97,-20+(i*12),31,2,1) 
   end
  end
 end
end

function _player()
 player={index_t={},index_s={}}
 for i=1,8 do
  local sp_t={s=i,x=8+(i*12),y=88,w=1,h=2,flip_h=false,flip_v=false,nar=true}
  local sp_s={s=i+32,x=8+(i*12),y=110,w=1,h=1,flip_h=false,flip_v=false,nar=true}
  if i==3 or i==5 then
   sp_t.nar=false sp_s.nar=false
  end
  add(player.index_t,sp_t) add(player.index_s,sp_s)
 end
 player.draw=function()
  for i=1,#player.index_t do
   if player.index_t[i].nar then
    sspr(8,24,8,8,player.index_t[i].x,player.index_t[i].y+11,8,8,player.index_t[i].flip_h,player.index_t[i].flip_v)

    sspr(8,24,8,8,player.index_s[i].x,player.index_s[i].y+3,8,8,player.index_s[i].flip_h,player.index_s[i].flip_v)
   else
    sspr(8,24,8,8,player.index_t[i].x-1,player.index_t[i].y+11,10,8,player.index_t[i].flip_h,player.index_t[i].flip_v)

    sspr(8,24,8,8,player.index_s[i].x-1,player.index_s[i].y+3,10,8,player.index_s[i].flip_h,player.index_s[i].flip_v)
   end
   ospr(player.index_t[i].s,player.index_t[i].x,player.index_t[i].y,player.index_t[i].w,player.index_t[i].h,player.index_t[i].flip_h,player.index_t[i].flip_v)

   ospr(player.index_s[i].s,player.index_s[i].x,player.index_s[i].y,player.index_s[i].w,player.index_s[i].h,player.index_s[i].flip_h,player.index_s[i].flip_v)
  end
 end
end

function setblack()
 for i=1,15 do
  pal(i,0)
 end
end

function ospr(sp,x,y,w,h,flip_h,flip_v)
 setblack()
 spr(sp,x-1,y,w,h,flip_h,flip_v)
 spr(sp,x+1,y,w,h,flip_h,flip_v)
 
 spr(sp,x,y-1,w,h,flip_h,flip_v)
 spr(sp,x,y+1,w,h,flip_h,flip_v)

 pal()
 _palette()

 spr(sp,x,y,w,h,flip_h,flip_v)
end
__gfx__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000444400000000000bbbb500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000044ccc4000000000b5afff500bbb55000222220000000000055555000444440000000000000000000000000000000000000000000000000000000000
000000000aaffa40022222005affffb0bbbaaa50222222200444c400555445500444444000000000000000000000000000000000000000000000000000000000
00000000af2ff2a0222cc220af2ff2a0baafffb02cc44cc04ccaac40544aa4504aaffa4000000000000000000000000000000000000000000000000000000000
000000000ff44ff022c44c20fff88ff0af2ff2f0c42442404aaffac05a2aa2a0af2ff2a000000000000000000000000000000000000000000000000000000000
0000000000ffff00c42442400affff00fff88ff0444224404f2ff2f04aa44aa00ff88f4000000000000000000000000000000000000000000000000000000000
0000000000022000244224400bbffb000fffff0004444400fff88ff00aaaaa0000fff44000000000000000000000000000000000000000000000000000000000
000000000222220022444400666bb6d000d1d00001122100caffffc00044400007bbb60000000000000000000000000000000000000000000000000000000000
000000000222220000cc2000ab6666a00e6e6e00eeeeee10c4aaaac006666b000f777f0000000000000000000000000000000000000000000000000000000000
000000000222220003333c00fb6666f006de6d0011eeee10989998900ab66a000f888f0000000000000000000000000000000000000000000000000000000000
000000000f111f0004c33400f11111f00e4c4e0041eeee40f33333f00a111a000f808f0000000000000000000000000000000000000000000000000000000000
0000000000e0e000042224000ee0ee000f404f004ddddd40fdddddf00ae0ea000080800000000000000000000000000000000000000000000000000000000000
0000000000e0e000002020000ee0ee00004040000ff0ff00fdddddf000e0e0000080800000000000000000000000000000000000000000000000000000000000
0000000000e0e000002020000ee0ee00004040000ff0ff000033300000e0e0000060600000000000000000000000000000000000000000000000000000000000
00000000007070000050500005d05d0000b0b00005b05b000070700000c0c0000070700000000000000000000000000000000000000000000000000000000000
0000000004c44400022222000444c4000ee44e000222220004444400022222000444440000000000000000000000000000000000000000000000000000000000
000000000caacc0022cc2c2044ccac40eee11ee0022cc2004c444440224442200444cc4000000000000000000000000000000000000000000000000000000000
000000000afffa002c4444204caffac04aaffa402c4444004c4aaac024aaaa204aaffac000000000000000000000000000000000000000000000000000000000
00000000ff2ff2f0c4244240af2ff2f0ff2ff2f0c42442404a2ff2f04a2aa2a0af2ff2a000000000000000000000000000000000000000000000000000000000
000000000ff44f00244224200ff88f000ff88f0004422400cff88fc00aa44a000ff88fc000000000000000000000000000000000000000000000000000000000
0000000000111000023332000ddddd00001b100001111100d99999d000bbb0000066644000000000000000000000000000000000000000000000000000000000
000000000feeef0004222400f11111f00fe6ef0004eee400fdddddf00a111a000f888f0000000000000000000000000000000000000000000000000000000000
0000000000707000005050000d60d60000c0c0000070700000c0c000004040000070700000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000033333000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000333333300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000b33333b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000bbbbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
d666d666022222222220000002222200000000000000222222222222000000002222220000000000000000000000000000000000000000000000000000000000
6666666627436142ce7200002d37c420000000022222777777777777000000227777772222222222000000000000000000000000000000000000000000000000
66d666d6277e97794772000024c71e20000222277777666666666666000022776666667777777777000000000000000000000000000000000000000000000000
66666666272e92294272000024c71e20022777766666666666666666002277666666666666666666000000000000000000000000000000000000000000000000
d666d666262e92294262000027777720277666666666666666666666027766666666666666666666000000000000000000000000000000000000000000000000
6666666626bbbbbbbb6200002bbbbb20227766666666666666666666276666666666666666666666000000000000000000000000000000000000000000000000
66d666d6262c21222c6200002bbbbb20252277666666666666666666222bbbb66666666666666666000000000000000000000000000000000000000000000000
66666666262c512b2c6200002bbbbb202b552277666666bbbbbbbbbb2552222bbbbb666666666666000000000000000000000000000000000000000000000000
0000000026246e26246200002bbbbb202bbb5522bbbbbb22222222222bb555522222bbbbbbbbbbbb000000000000000000000000000000000000000000000000
0000000026bbbbbbbb6200002bbbbb202bbbbb5522222255555555552bbbbbb55555222222222222000000000000000000000000000000000000000000000000
0000000026222312216200002bbbbb202bbbbbbb5555555b555555552bbbbbbbbbbb555555555555000000000000000000000000000000000000000000000000
0000000026252312216200002bbbbb202bbbbbbbb5bbb5b5555555552bbbbbbbbbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000
0000000026262de22e6200002bbbbb2032bbbbbbbbb5bb5b555555552bbbbbbbbbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000
0000000026bbbbbbbb6200002bbbbb20b322bbbbb5bbb5b555555555322bbbbbbbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000
0000000026221222226200002bbbbb200b3322bbbbb5bb5b55555555b332222bbbbbbbbbbbbbbbbb000000000000000000000000000000000000000000000000
00000000262212c2c26200002bbbbb2000bb3322b5bbb522222222220bb333322222bbbbbbbbbbbb000000000000000000000000000000000000000000000000
000000002622e242426200002bbbbb200000bb332222223333333333000bbbb33333222222222222000000000000000000000000000000000000000000000000
0000000026bbbbbbbb6200002bbbbb20000000bb333333bbbbbbbbbb0000000bbbbb333333333333000000000000000000000000000000000000000000000000
0000000032222222222300003222223000000000bbbbbb0000000000000000000000bbbbbbbbbbbb000000000000000000000000000000000000000000000000
00000000b3333333333b0000b33333b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000bbbbbbbbbb000000bbbbb00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
